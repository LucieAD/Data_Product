---
title: The Immunity and Infection Immunophenotyping screen
author: "Lucie AD"
date: "1 January 2018"
output:
  ioslides_presentation:
    widescreen: true
    smaller: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## The Infection and Immunity Immunohentyping consortium

The Infection and Immunity Immunophenotyping (3i) consortium conducts a high-throughput immunological phenotyping of over 500 knockout mouse lines generated by the Wellcome Trust Sanger Institute in Cambridge, UK.
<br><br>
For further information, visit [immunophenotype.org](www.immunophenotype.org).

## Aims of the consortium

- better understand gene function
- help patients with rare monogenetic diseases understand their condition
- develop mouse models for these diseases
- identify new pathways and proteins that could be targets for drug design

## Phenotypic screening

The phenotyping has two components, an observational screen and a challenge screen.
<br><br>
In the observational screen, the immune cell compartments of blood, spleen, mesenteric ymph nodes and bone marrow are analysed by flow cytometry. In addition, immune cells in the ear epidermis is analysed by confocal microscopy, the presence of anti-nuclear antibodies is determined in serum and the cytotoxic potential of splenic CD8 T cells is determined. The aim of the oservational screen is to identify genes which regulate the immune system at steady state.
<br><br>
The challenge screen looks at responses to chemical stress (DSS colitis), viral infection (influenza), bacterial infection (*Salmonella typhimurium*), and parasitic infection (*Trichuris muris*). The aim of the challenge screen is to identify genes that are crucial for the immune system to respond to infections and chemical stress.
<br>
An overview of the results is presented on the next slide.

## Summary of results

```{r, echo=FALSE, , message=FALSE, warning=FALSE, fig.width = 9, fi.heigt=6}
require(ggplot2)
require(plotly)

## Load data
blob <- read.csv("blob_plotly.csv", row.names = 1, header= TRUE)

## Define colour palette
colour_palette <- c("#5E4FA2","#3288BD","#66C2A5","#ABDDA4" , "#E6F598","#FEE08B","#FDAE61", "#F46D43","#D53E4F","#9E0142" )

## Define breaks
bubble_breaks <- c(0,5,10,20,40,80,100)
pubmed_breaks <- c(0,5,10,15,30,50,100,200,500,7000)
pubmed_labels <- c("0-5","5-10","10-15","15-30","30-50","50-100","100-200","200-500","500-7000")

## Create text for hover
blob$hover <- paste(blob$Gene.Symbol, "\n", blob$Immune.sum, " affected test(s)", "\n", blob$No.of.flow.parameter, " affected flow parameter(s)", "\n", "mentioned in ", blob$Abstract.sum, " pubmed article(s)",  sep="")

## Blob
g <- ggplot(blob,aes(x=SS.at.all,y=Challenge.at.all,size=No.of.flow.parameters,fill=as.factor(cut(Abstract.sum, breaks=pubmed_breaks, labels=pubmed_labels, include.lowest = TRUE))))+
  geom_jitter(aes(text=hover), height=0.4,width=0.4,shape=21,alpha=0.8,set.seed(6))+
  scale_size(range=c(4,25),breaks = bubble_breaks)+
  theme_classic()+
  scale_fill_manual(values=colour_palette)+
  geom_vline(xintercept = 0.5,linetype="longdash")+
  geom_hline(yintercept=0.5,linetype="longdash")+
  theme(legend.title=element_blank())+
  xlab("Steady state phenotype")+
  ylab("Challenge phenotype")+
  theme(axis.text.x = element_text(colour="white"))+
  theme(axis.text.y = element_text(colour="white"))+
  theme(axis.title = element_text(size=16))+
  guides(fill=guide_legend(override.aes=list(size=5)))

## Plotly
gp <- ggplotly(g, tooltip="text") %>%
  add_annotations( text=paste("No of pubmed ", "\n", "articles"), xref="paper", yref="paper",
                   x=1.02, xanchor="left",
                   y=0.9, yanchor="bottom",
                   legendtitle=TRUE, showarrow=FALSE ) %>%
  layout(legend=list(y=0.9, yanchor="top"))
gp

```
<br>
Bubble size denotes the number of affected flow-cytometric parameters.<br>
Mouse over to get the gene name.
